# Gladiator Ludus Simulator

Симулятор/песочница про управление лудусом: найм гладиаторов, тренировки, экономика и бои.

## Tech
- Godot 4.x (.NET) + C#
- .NET SDK 8+
- Тесты: xUnit (ядро симуляции отдельно от движка)

## Репозиторий
- `game/` — Godot проект (UI/сцены/визуализация)
- `src/Ludus.Core/` — чистое доменное ядро (симуляция, баланс, бой)
- `src/Ludus.Tests/` — тесты на ядро
- `docs/` — дизайн, ADR, заметки по балансу

## Быстрый старт

### Запуск игры в Godot
1) Установить Godot 4.x .NET и .NET SDK 8+
2) Открыть `game/project.godot` в редакторе Godot
3) Дождаться автоматической сборки C# проекта (внизу статус-бар)
4) Нажать кнопку Play (F5) для запуска

### Запуск тестов ядра
- `dotnet test` — запустить все тесты xUnit в `src/Ludus.Tests/`

## MVP-петля (первая цель)
1) Нанять 3 гладиаторов
2) Назначить тренировки на неделю
3) Провести бой (авторезолв)
4) Получить деньги/травмы/прогресс
5) Повторить

### Поведение боя в UI
- После симуляции боя результат применяется к `LudusState`.
- Победитель сохраняет остаток HP, проигравший остаётся в ростере с `HP = 0`.
- Игра остаётся в основном экране: можно сразу продолжать найм, дни и следующие бои.

## Post-MVP Roadmap

### [x] Issue-0: Post-MVP roadmap in README
- Goal:
  - фиксируем post-MVP направление, декомпозицию задач и критерии проверки в документации.
- Scope:
  - только документация (`README.md`), без изменений игрового кода.
- Definition of Done:
  - roadmap и правила исполнения описаны в `README.md`;
  - у каждого следующего issue есть цель и "как проверить";
  - `dotnet test` проходит без регрессий.

### [ ] Issue-A: UI Foundation v2
- Goal:
  - сделать более живой и читаемый основной экран (HUD, ростер, бой, события).
- Changes:
  - `game/scenes/Main.tscn`, `game/scripts/Main.cs` (только UI/интеграция, без переноса логики из Core).
- How to verify:
  1) интерфейс читаем на desktop/mobile;
  2) текущие сценарии MVP (new game, hire, advance day, fight) работают как раньше;
  3) нет регрессии в отображении статуса боя и списка гладиаторов.

### [ ] Issue-B: Asset Pack v1 Integration
- Goal:
  - добавить первые ассеты для атмосферы и читаемости.
- Changes:
  - иконки статов, фон арены, карточки гладиаторов, базовые SFX-плейсхолдеры.
- How to verify:
  1) ассеты загружаются без ошибок;
  2) нет битых путей/ресурсов в Godot;
  3) визуал не ломает существующие UI-сценарии.

### [ ] Issue-C: Training System v1 (Core-first)
- Goal:
  - добавить назначение тренировок и применение эффектов на дневном тике.
- Changes:
  - `src/Ludus.Core` + тесты в `src/Ludus.Tests`.
- How to verify:
  1) одинаковый `seed` -> одинаковый прогресс;
  2) тесты на ограничения, прирост статов и инварианты проходят;
  3) UI только отображает состояние, логика живет в Core.

### [ ] Issue-D: Injuries & Recovery v1
- Goal:
  - добавить травмы после боя и восстановление по дням.
- Changes:
  - шанс/тип травмы, длительность восстановления, ограничения участия в бою.
- How to verify:
  1) травмы детерминированы по seed;
  2) боец в восстановлении корректно ограничен;
  3) тесты проверяют граничные случаи и снятие ограничений.

### [ ] Issue-E: Morale/Fatigue v1
- Goal:
  - добавить мораль и усталость как факторы эффективности.
- Changes:
  - расчет модификаторов для боя/тренировок, переходы состояний по дням.
- How to verify:
  1) значения находятся в валидных диапазонах;
  2) формулы покрыты unit-тестами;
  3) UI корректно показывает состояние без бизнес-логики в Godot.

### [ ] Issue-F: Contracts & Wages v1
- Goal:
  - ввести контракты и регулярные выплаты/риски ухода.
- Changes:
  - контрактные условия, продление, последствия просрочки выплат.
- How to verify:
  1) денежные расчеты детерминированы;
  2) тесты покрывают просрочку, продление и уход;
  3) экономика не нарушает базовые инварианты `LudusState`.

### [ ] Issue-G: Daily Events v1
- Goal:
  - добавить события дня с выбором игрока и последствиями.
- Changes:
  - event-driven модель дневных событий в Core и отображение в UI.
- How to verify:
  1) события воспроизводимы по seed;
  2) выбор игрока дает корректные и тестируемые последствия;
  3) поведение не ломает текущий loop по дням.

## Visual Direction v1
- Mood:
  - gritty arena management, "грязный" римский менеджмент, а не стерильный UI.
- UI priorities:
  - четкие панели: ростер, экономика, бой, события;
  - контрастные состояния (раны, усталость, победа/поражение);
  - читаемость важнее декоративной плотности.
- First assets:
  - иконки `STR/AGI/STA`, статусы `Injured/Fit/Tired`;
  - 1-2 фоновых изображения арены;
  - базовые карточки гладиатора и простые аудио-плейсхолдеры.

## Mechanics Direction v1 (Ludus Management)
- Core loop after MVP:
  1) найм/состав;
  2) план тренировок;
  3) дневной тик (экономика/восстановление/события);
  4) бой и последствия;
  5) корректировка состава и планов.
- Pillars:
  - тренировки;
  - травмы и восстановление;
  - мораль/усталость;
  - контракты и выплаты;
  - события дня.
- Core rule:
  - вся симуляция и бизнес-правила в `src/Ludus.Core`;
  - Godot-слой (`game/`) отвечает только за UI/визуал/интеграцию.

## Execution Policy
- `1 Issue = 1 PR` без смешения feature и refactor.
- Перед реализацией любой фичи обязательно пройти flow:
  1) выбрать фичу из раздела `Post-MVP Roadmap`;
  2) подготовить отдельный план по выбранной фиче (scope, AC, test cases, touched areas);
  3) получить явный апрув плана;
  4) только после апрува начинать реализацию в отдельной issue-ветке.
- Для каждого issue:
  0) если числового GitHub issue ещё нет, сначала создать issue в GitHub и зафиксировать его номер `#<number>`;
  1) ветка `issue/<number>-<slug>` от актуальной `main`;
  2) изменения только в рамках issue;
  3) PR с явной связью `Fixes #<number>` или `Closes #<number>`;
  4) тесты обязательны для изменений в `src/Ludus.Core`;
  5) при изменении поведения/архитектуры обновляется документация;
  6) после merge соответствующего PR выполненный issue обязательно помечается в roadmap как сделанный (`[x]`).
